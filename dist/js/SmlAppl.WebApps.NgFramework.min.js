!function(){"use strict";angular.module("smlAppl.webApps.framework.controllers",[]),angular.module("smlAppl.webApps.framework.directives",[]),angular.module("smlAppl.webApps.framework.filters",[]),angular.module("smlAppl.webApps.framework.services",[]),angular.module("smlAppl.webApps.framework",["smlAppl.webApps.framework.controllers","smlAppl.webApps.framework.directives","smlAppl.webApps.framework.filters","smlAppl.webApps.framework.services","smlAppl.webApps.framework.filterTable"])}(),function(){"use strict";angular.module("smlAppl.webApps.framework.filterTable.controllers",[]),angular.module("smlAppl.webApps.framework.filterTable.directives",[]),angular.module("smlAppl.webApps.framework.filterTable",["smlAppl.webApps.framework.filterTable.controllers","smlAppl.webApps.framework.filterTable.directives"])}(),function(){"use strict";angular.module("smlAppl.webApps.framework.directives").directive("elastic",["$timeout",function(a){return{restrict:"A",link:function(b,c){c[0].style.overflowY="hidden",b.initialHeight=b.initialHeight||c[0].style.height;var d=function(){c[0].style.height=b.initialHeight,c[0].style.height=""+c[0].scrollHeight+"px"};c.on("input change",d),a(d,0)}}}])}(),angular.module("smlAppl.webApps.framework.filterTable").run(["$templateCache",function(a){"use strict";a.put("wwwroot/FilterTable/Views/FilterTable.html",'<style>\r\n	select[value=""] {\r\n		color: gray;\r\n	}\r\n</style>\r\n\r\n<div class="row">\r\n	<div class="col-md-12" style="text-align: center;">\r\n		<span ng-hide="!loading">Loading <img src="Content/images/loader-horizontal.gif" /></span>\r\n	</div>\r\n	<div class="col-md-12" style="text-align: center;">\r\n		<span ng-show="error">Fehler beim Beziehen der Daten.</span>\r\n	</div>\r\n</div>\r\n\r\n<script type="text/ng-template" id="myModalContent.html">\r\n    <div class="modal-header">\r\n        <h3 class="modal-title">Einstellungen</h3>\r\n    </div>\r\n    <div class="modal-body">\r\n        <uib-tabset>\r\n            <uib-tab heading="Spalten" ng-if="Options.CanSelectCols">\r\n                <table class="table table-bordered table-condensed table-responsive table-striped table-hover">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Name</th>\r\n                            <th>Sichtbar</th>\r\n                            <th>Dropdown</th>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>\r\n                                <input name="theColFilter.display" ng-model="theColFilter.display" placeholder="Name" />\r\n                            </td>\r\n                            <td>\r\n                                <input type="checkbox" ng-model="visible.all" ng-change="ChangeVisible(visible.all)" /> Alle\r\n                            </td>\r\n                            <td></td>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr ng-repeat="col in Options.CurrentCols | filter: theColFilter">\r\n                            <td>{{::col.display | translate}}</td>\r\n                            <td><input type="checkbox" ng-model="col.visible" /></td>\r\n                            <td><input type="checkbox" ng-model="col.select" ng-change="ChangeDropDown(col)" ng-disabled="Options.NoSearchSelects || !col.canSelect" /></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </uib-tab>\r\n            <uib-tab heading="Tabelle" ng-if="true">\r\n                <table class="table table-bordered table-condensed table-responsive table-striped table-hover">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Setting</th>\r\n                            <th>Wert</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>Suche aktiv</td>\r\n                            <td><input type="checkbox" ng-model="Options.SearchActive" /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Keine Dropdowns</td>\r\n                            <td><input type="checkbox" ng-model="Options.NoSearchSelects" /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Dropdowns einschr채nken</td>\r\n                            <td><input type="checkbox" ng-model="Options.ReduceSelects" /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Datens채tze pro Seite</td>\r\n                            <td><input type="number" ng-model="Options.PageSize" ng-model-options="ModelOptions" /></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </uib-tab>\r\n        </uib-tabset>\r\n    </div>\r\n    <div class="modal-footer">\r\n        <button class="btn btn-primary" type="button" ng-click="ok()">OK</button>\r\n        <!--<button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>-->\r\n    </div>\r\n\r\n</script>\r\n\r\n<div ng-hide="loading || error">\r\n    <div class="row">\r\n        <div class="col-md-12">\r\n            <div style="overflow: auto;">\r\n                <table class="table table-bordered table-condensed table-responsive table-striped table-hover">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>\r\n                                <span type="button" class="btn btn-default btn-sm" ng-click="open()" ng-show="Options.CanCustomize"><span class="glyphicon glyphicon-cog"></span></span>\r\n                            </th>\r\n                            <th ng-repeat="col in Options.VisibleCols" style="padding-left: 10px; padding-right: 40px; vertical-align: middle;">\r\n                                <span class="pull-left">{{::col.display | translate}}</span>\r\n                                <span style="margin-right: -30px; opacity: 0.5; cursor: pointer;" class="pull-right {{GetOrderIndicator(col)}}" ng-click="OrderBy(col)"></span>\r\n                            </th>\r\n                        </tr>\r\n                        <tr ng-show="Options.SearchActive">\r\n                            <th>\r\n                                <span type="button" class="btn btn-default btn-sm" ng-click="clearFilter()"><span class="glyphicon glyphicon-remove"></span></span>\r\n                            </th>\r\n                            <th ng-repeat="col in Options.VisibleCols">\r\n                                <select class="select2" name="theFilter{{::col.key}}" ng-model="theFilter[col.key]" ng-if="col.select && hasDistincts(col.key)">\r\n                                    <!-- acts as placeholder -->\r\n                                    <option ng-repeat="item in Distincts[col.key] | orderBy " value="{{::item}}">{{ ::item | translate }}</option>\r\n                                </select>\r\n                                <input type="text" name="theFilter{{::col.key}}" ng-model="theFilter[col.key]" ng-model-options="ModelOptions" ng-if="!col.select || !hasDistincts(col.key)" />\r\n                            </th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr ng-if="PassedData.length === 0 && !Options.InitialEmpty">\r\n                            <td colspan="100%" class="warning">Keine Daten gefunden.</td>\r\n                        </tr>\r\n                        <tr ng-if="Options.VisibleCols.length > 0" ng-repeat="item in DisplayedData">\r\n                            <td></td>\r\n                            <!--<td ng-repeat="col in Options.VisibleCols">{{::GetVal(item, col)}}</td>-->\r\n                            <td ng-\r\n                            <td ng-repeat="col in Options.VisibleCols"><span ng-bind-html="::GetVal(item, col)"></span></td>\r\n                        </tr>\r\n                        <tr ng-if="PassedData.length > 0 && (FilteredData.length == 0)">\r\n                            <td colspan="100%" class="warning">Filter enth채lt keine Daten.</td>\r\n                        </tr>\r\n                    </tbody>\r\n\r\n                </table>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-md-12">\r\n            <div class="pull-right">\r\n                <button class="btn btn-default" style="float: left;" ng-click="SetCurrentPage(1)" ng-disabled="settings.backwardDisabled"><i class="fa fa-fast-backward"></i></button>\r\n                <button class="btn btn-default" style="float: left;" ng-click="SetCurrentPage(settings.currentPage-1)" ng-disabled="settings.backwardDisabled"><i class="fa fa-step-backward"></i></button>\r\n                <div style="float: left; text-align: right;">\r\n                    <select ng-model="settings.currentPage" ng-change="SetCurrentPage(settings.currentPage)"\r\n                            ng-options="item as item for item in settings.filterPageArray"></select>\r\n                    Seite {{ settings.currentPage }} von {{ settings.filterPageCount }} ({{settings.totalPageCount}} Total)\r\n\r\n                </div>\r\n                <button class="btn btn-default" style="float: right;" ng-click="SetCurrentPage(settings.filterPageCount)" ng-disabled="settings.forwardDisabled"><i class="fa fa-fast-forward"></i></button>\r\n                <button class="btn btn-default" style="float: right;" ng-click="SetCurrentPage(settings.currentPage+1)" ng-disabled="settings.forwardDisabled"><i class="fa fa-step-forward"></i></button>\r\n            </div>\r\n            <div style="float: left;">Datens채tze: {{FilteredData.length}} von {{PassedData.length}}</div>\r\n        </div>\r\n\r\n    </div>\r\n</div>')}]),function(){"use strict";angular.module("smlAppl.webApps.framework.filterTable.controllers").controller("FilterTableModalInstanceCtrl",function(a,b,c,d){a.Options=d,a.visible={},a.visible.all=a.Options.CurrentCols.length===a.Options.CurrentCols.filter(function(a,b,c){return a.visible}).length,a.theColFilter={},a.ModelOptions={debounce:{"default":500,blur:0}},a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")},a.ChangeVisible=function(b){for(var d=a.Options.CurrentCols.filter(function(a,c,d){return a.visible!==b}),e=c("filter")(d,a.theColFilter),f=0;f<e.length;f++)e[f].visible=b},a.ChangeDropDown=function(b){b.select&&a.Options.buildDistinctsFor(b)}})}(),function(){"use strict";angular.module("smlAppl.webApps.framework.filterTable.directives").directive("filterTable",function(a,b,c,d,e){return{restrict:"E",scope:{data:"=items",Options:"=options",columns:"=",canCustomize:"=",canSelectCols:"=",searchActive:"=",noSearchSelects:"=",reduceSelects:"=",order:"=",pageSize:"=",selectsOnColumns:"=",noSelectsOnColumns:"=",ignoreColumns:"=",initialEmpty:"="},templateUrl:"wwwroot/FilterTable/Views/FilterTable.html",link:function(e,f,g){function h(a,b){return angular.isDefined(a)&&angular.isArray(e.$eval(a))?e.$eval(a):b}function i(){return e.PassedData.length>0}function j(a){var b={CanCustomize:e.canCustomize,CanSelectCols:e.canSelectCols,Columns:e.columns,SearchActive:e.searchActive,NoSearchSelects:e.noSearchSelects,ReduceSelects:e.reduceSelects,Order:e.order,PageSize:e.pageSize,SelectsOnColumns:h(g.selectsOnColumns,[]),NoSelectsOnColumns:h(g.noSelectsOnColumns,[]),IgnoreColumns:h(g.ignoreColumns,[]),InitialEmpty:e.initialEmpty},c=a===!0?e.Options:{},d=$.extend(!0,c,u,e.Options,b);d.Provided=d.Columns.length>0,(d.Provided||a===!0)&&n(d),e.Options=d}function k(a,b){return a.NoSearchSelects?!1:a.NoSelectsOnColumns.indexOf(b)>-1?!1:!0}function l(a,b){return k(a,b)&&a.SelectsOnColumns.indexOf(b)>-1?!1:!1}function m(a,b){return a.IgnoreColumns.indexOf(b)>-1?!0:!1}function n(a){var b,c,d,f={key:null,ignore:!1,visible:!1,display:void 0,canSelect:!0,select:!1,orderAsc:void 0},g=[];if(a.Provided)g=angular.copy(a.Columns);else if(i()){var h=e.data[0];for(var j in h)if(h.hasOwnProperty(j)&&"$$hashKey"!==j){var n=a.ColByName[j]||{};g.push($.extend({},f,n,{key:j}))}}for(a.Cols=[],a.ColByName={},a.CurrentCols=[],b=0;b<g.length;b++)d=g[b],c=d.key||null,null!=c?(d=$.extend({},f,{display:d.display||d.key,index:b,canSelect:k(a,c),select:l(a,c),ignore:m(a,c)},d),g[b]=d,""===a.Order.OrderBy&&angular.isDefined(d.orderAsc)&&(a.Order.OrderBy=d.key,a.Order.Asc=d.orderAsc),angular.isDefined(d.key)&&(a.Cols.push(d),a.ColByName[d.key]=d)):(console.log("invalid item - missing 'key':"),console.log(d));return a.CurrentCols=a.Cols.filter(function(a,b,c){return!a.ignore}),a.VisibleCols=a.CurrentCols.filter(function(a,b,c){return a.visible}),a}function o(a){for(var b=[],c=1;a>=c;c++)b.push(c);return b}function p(){if(!e.Options.NoSearchSelects){for(var a={},b=e.Options.ReduceSelects?e.FilteredData:e.PassedData,c=0;c<e.Options.CurrentCols.length;c++){var d=e.Options.CurrentCols[c];if(d.select){for(var f={},g=0;g<(b||[]).length;g++){var h=b[g];angular.isDefined(h[d.key])&&null!==h[d.key]&&(f[h[d.key].toString()]="")}a[d.key]=[],a[d.key].push("");for(var i in f)""!==i&&a[d.key].push(i)}}e.Distincts=a}}function q(){e.BuildingUp=!0,e.PassedData=d("orderBy")(e.data||[],e.GetOrderInfo()),e.settings.totalPageCount=e.GetPageCount(e.PassedData.length),t(!0),r()}function r(){e.BuildingUp=!0,e.FilteredData=a(e.PassedData,e.theFilter),e.settings.currentPage=1,e.settings.filterPageCount=e.GetPageCount(e.FilteredData.length),e.settings.filterPageArray=o(e.settings.filterPageCount),p(),s()}function s(){e.BuildingUp=!0;var a=(e.settings.currentPage-1)*e.Options.PageSize;a>e.FilteredData.length?e.DisplayedData=[]:e.DisplayedData=e.FilteredData.slice(a,a+e.Options.PageSize),e.settings.backwardDisabled=1===e.settings.currentPage,e.settings.forwardDisabled=e.settings.currentPage===e.settings.filterPageCount,e.BuildingUp=!1}function t(a){e.error=!1,c.cancel(e.timeout),a===!0&&!e.Options.Provided&&i()?j(!0):e.Options.CurrentCols=e.Options.Cols.filter(function(a,b,c){return!a.ignore}),e.loading=!a&&!i(),e.loading&&(e.timeout=c(function(){e.loading=!1,e.error=!e.Options.Provided},1e4))}e.loading=!0,e.error=!1,e.timeout={},e.ModelOptions={debounce:{"default":500,blur:0}},e.Distincts={};var u={CanCustomize:!0,CanSelectCols:!0,Columns:[],SearchActive:!0,NoSearchSelects:!1,ReduceSelects:!1,Order:{OrderBy:"",Asc:!0},PageSize:15,SelectsOnColumns:[],NoSelectsOnColumns:[],IgnoreColumns:[],Provided:!1,ColByName:{},Cols:[],CurrentCols:[],VisibleCols:[],InitialEmpty:!1};j(),e.$watch("inOpts",function(a,b){a!==b&&(j(),q())},!0),e.$watch("options",function(a,b){a!==b&&(j(),q())},!0),e.$watch("columns",function(a,b){a!==b&&(j(),q())},!0),e.$watch("Options.Cols",function(a,b){a!==b&&(e.Options.CurrentCols=e.Options.Cols.filter(function(a,b,c){return!a.ignore}),e.Options.VisibleCols=[],e.Options.VisibleCols=e.Options.CurrentCols.filter(function(a,b,c){return a.visible}))},!0),e.$watch("Options.SearchActive",function(a,b){a||e.clearFilter()},!0),e.$watch("Options.NoSearchSelects",function(a,b){if(a)for(var c=e.Options.Cols.filter(function(a,b,c){return a.select}),d=0;d<c.length;d++)c[d].select=!1},!0),e.$watch("Options.ReduceSelects",function(a,b){q()},!0),e.$watch("Options.Order.OrderBy",function(a,b){var c=e.Options.ColByName[b];angular.isDefined(c)&&null!==c&&(c.orderAsc=void 0);var d=e.Options.ColByName[a];angular.isDefined(d)&&null!==d&&(d.orderAsc=e.Options.Order.Asc)},!0),e.$watch("Options.Order.Asc",function(a,b){var c=e.Options.ColByName[e.Options.Order.OrderBy];angular.isDefined(c)&&null!==c&&(c.orderAsc=e.Options.Order.Asc)},!0),e.$watch("Options.PageSize",function(a,b){null===a||""===a||angular.isUndefined(a)||isNaN(a)?e.Options.PageSize=b:q()},!0),e.settings={currentPage:1,filterPageCount:1,totalPageCount:1,filterPageArray:[1],backwardDisabled:!0,forwardDisabled:!0},e.GetPageCount=function(a){return 0===e.Options.PageSize?0:Math.ceil(a/e.Options.PageSize)},e.SetCurrentPage=function(a){e.settings.currentPage=Number(a),s()},e.Options.buildDistinctsFor=function(b){if(!e.Options.NoSearchSelects){var c=[];if(b.select){for(var d=e.Options.ReduceSelects?a(e.data,e.theFilter):e.data,f={},g=0;g<d.length;g++){var h=d[g];angular.isDefined(h[b.key])&&null!==h[b.key]&&(f[h[b.key].toString()]="")}c.push("");for(var i in f)""!==i&&c.push(i)}e.Distincts[b.key]=c}},e.Options.DistinctsFrom=function(a,b){for(var c=[],d={},e=0;e<a.length;e++){var f=a[e];angular.isDefined(f[b])&&null!==f[b]&&(d[f[b].toString()]="")}c.push("");for(var g in d)""!==g&&c.push(g);return c},e.hasDistincts=function(a){return!angular.isUndefined(e.Distincts[a])},e.theFilter={},e.clearFilter=function(){e.theFilter={}},e.$watch("theFilter",function(a){e.settings.currentPage=1;var b=!1;for(var c in a)""===a[c]&&(b=!0,delete a[c]);b&&(e.theFilter=a),r()},!0),e.$watch("data",function(){q()}),e.PassedData=[],e.BuildingUp=!0,e.FilteredData=[],e.DisplayedData=[],e.GetVal=function(a,b){return angular.isDefined(b.filter)?e.$eval("item[col.key] | "+b.filter,{item:a,col:b}):a[b.key]},e.OrderBy=function(a){e.Options.Order.OrderBy===a.key?e.Options.Order.Asc=!e.Options.Order.Asc:(e.Options.Order.OrderBy=a.key,e.Options.Order.Asc=!0),q()},e.GetOrderInfo=function(){var a=(e.Options.Order.Asc?"":"-")+e.Options.Order.OrderBy;return a},e.IsOrdered=function(a){return e.Options.Order.OrderBy===a.key},e.GetOrderIndicator=function(a){return e.IsOrdered(a)?e.Options.Order.Asc?"glyphicon glyphicon-sort-by-alphabet":"glyphicon glyphicon-sort-by-alphabet-alt":"glyphicon glyphicon-sort"},e.animationsEnabled=!0,e.open=function(a){var c=b.open({animation:e.animationsEnabled,templateUrl:"myModalContent.html",controller:"FilterTableModalInstanceCtrl",size:a,resolve:{options:function(){return e.Options}}});c.result.then(function(){},function(){})}}}})}(),angular.module("smlAppl.webApps.framework.filters").filter("chDate",["$filter",function(a){var b=a("date");return function(a){return b(a,"dd.MM.yyyy")}}]).filter("chDateTime",["$filter",function(a){var b=a("date");return function(a){return b(a,"dd.MM.yyyy HH:mm:ss")}}]),function(){"use strict";angular.module("smlAppl.webApps.framework.filters").filter("decimal",["$filter",function(a){var b=a("number");return function(a,c){return c&&angular.isNumber(c)||(c=0),b(a,c)}}])}(),angular.module("smlAppl.webApps.framework.services").service("HttpHandler",["$q",function(a){this.handleError=function(b){return console.log(b),angular.isObject(b.data)||b.statusText||(b.statusText="An unknown error occurred."),a.reject(b)},this.handleSuccess=function(a){return a.data}}]);